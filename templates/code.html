<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>SubjectHelper - –ß–∞—Ç</title>
  <link rel="stylesheet" href="back.css">
</head>
<body>
  <header>
   <a href="welcome.html">
      <img class="logo" src="img/logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø">
    </a>
  </header>

  <main>

    <h1>AI-–†–µ–ø–µ—Ç–∏—Ç–æ—Ä</h1>
    <div class="info-bar">
      <p id="selected-info"></p>
    </div>
    <div class="mode-info" id="mode-info"></div>

    <section class="main">

      <div class="chat" id="chat"></div>
      <div class="input-container">
        <textarea id="question" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å..."></textarea>
          <button onclick="askTutor()">–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å</button>
          <button onclick=#> + </button>
      </div>
    </section>
  </main>

  <script>

    const menu = document.getElementById("menu");

     const chat = document.getElementById("chat");
     const textarea = document.getElementById("question");

     const subject = localStorage.getItem("subject") || "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞";
     const mode = localStorage.getItem("mode") || "explain";




const modeText = {
  explain: "üß† –û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ç–µ–º—ã",
  step: "üìö –†–µ—à–µ–Ω–∏–µ –ø–æ —à–∞–≥–∞–º",
  quiz: "üéØ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞–Ω–∏–π",
  exam: "üíØ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —ç–∫–∑–∞–º–µ–Ω—É"
};

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
document.getElementById("selected-info").innerText =
  `–ü—Ä–µ–¥–º–µ—Ç: ${subject} | –†–µ–∂–∏–º: ${modeText[mode] || mode}`;




    window.addEventListener("load", () => {
      const aiMessage = document.createElement("div");
      aiMessage.className = "message ai";
      aiMessage.innerText = "–ü—Ä–∏–≤–µ—Ç! –Ø —Ç–≤–æ–π –ª–∏—á–Ω—ã–π —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä. –ó–∞–¥–∞–π –º–Ω–µ –≤–æ–ø—Ä–æ—Å, –∏ —è –ø–æ–º–æ–≥—É —Ç–µ–±–µ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è.";
      chat.appendChild(aiMessage);
      textarea.focus();
    });
    async function askTutor() {
    const question = document.getElementById("question").value.trim();
    if (!question) return;

    const chat = document.getElementById("chat");

    const userMessage = document.createElement("div");
    userMessage.className = "message user";
    userMessage.innerText = question;
    chat.appendChild(userMessage);

    document.getElementById("question").value = "";





     const res = await fetch("http://localhost:5000/ask", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        question,
        subject,
        mode
      })
    });

    const data = await res.json();

    const aiMessage = document.createElement("div");
    aiMessage.className = "message ai";
    aiMessage.innerText = data.answer;
    chat.appendChild(aiMessage);

    chat.scrollTop = chat.scrollHeight;
  }


</script>

</body>
</html>
